<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600646 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1387"/>

<div>
<span><div><div style="text-align: center;"><font style="font-size: 14pt;"><b>项目搭建</b></font></div><div><font style="font-size: 12pt;">1.项目的搭建,前后端分离</font></div><div><font style="font-size: 12pt;">2.创建api项目,单独存放接口(controller,interceptor,自己要用到的依赖,引入core的依赖,parent依赖)</font></div><div><font style="font-size: 12pt;">3.创建core项目,放入核心的,公用的(domain,mapper,service,query,util,applicationContext.xml,db.properties.xml</font><span style="font-size: 12pt;">,自己要用到的依赖,引入parent依赖</span><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;">4.创建admin项目为后台管理项目,(存放后台的controller,web)</font></div><div><font style="font-size: 12pt;">5.创建一个trip项目(parent项目),存放(api项目,core项目,domain项目,parent依赖)</font></div><div><font style="font-size: 12pt;">6.为什么要单独创建一个后台项目admin来管理后台的controller,web?</font></div><div><font style="font-size: 12pt;">(1)前后端分离,后台是给公司内部人员使用的,用户是没必要访问的,如果有用户猜到项目的结构,访问了后台,这样就存在安全问题</font></div><div><font style="font-size: 12pt;">(2)代码维护会好一些</font></div><div><font style="font-size: 12pt;">(3)性能问题,前端项目的访问量比后台项目多得多,分离开来可以减少对后台服务器的并发压力</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">7.项目的依赖</font></div><div><font style="font-size: 12pt;">(1)</font><span style="font-size: 12pt;">parent.pom.xml:</span></div><ul><li><div><span style="font-size: 16px;">commons-fileupload  文件上传</span></div></li><li><div><span style="font-size: 16px;">javax.servlet-api 提供编写servlet用到的</span> <span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px; font-variant-ligatures: common-ligatures; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">HttpServletRequest和HttpServletResponse等对象</span></div></li><li><div><font color="#4D4D4D" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;">junit 单元测试框架 @Test </span></font></div></li><li><div><font color="#4D4D4D" face="Microsoft YaHei, SF Pro Display, Roboto, Noto, Arial, PingFang SC, sans-serif"><span style="font-size: 16px; font-variant-ligatures: common-ligatures;">lombok 通过注解的方式给domain提供getter,setter,构造器,toString等方法,简化代码</span></font></div></li><li><div><span style="font-size: 12pt; color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;;">slf4j-log4j12 打印日志,执行SQL的时候可以看到日志,配合log4j.properties使用</span></div></li><li><div><span style="font-size: 12pt;">org.springframework Spring框架  </span></div></li><ul><li><div><span style="font-size: 12pt;">spring-context</span></div></li><li><div><span style="font-size: 16px;">spring-test spring的测试框架,整合junit进行单元测试</span></div></li><ul><li><div><span style="font-size: 12pt;">@RunWith(SpringJUnit4ClassRunner.class)  //使用junit4进行测试</span><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;">@ContextConfiguration() 加载spring相关的配置文件</span><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;">    </span><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;">    </span><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;">    </span><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;">  </span> <span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;">@WebAppConfiguration() 设置web项目的环境，如果是Web项目，必须配置该属性，否则无法获取 web 容器相关的信息（request、context 等信息）</span></div></li></ul></ul><ul><li><div><span style="font-size: 12pt;">spring-webmvc  springMVC框架</span></div></li><li><div><span style="font-size: 12pt;">aspectjweaver springAOP  </span></div></li><ul><li><div><span style="font-size: 16px;">为什么要有SpringAOP?</span></div></li><ul><li><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: &quot;Microsoft YaHei UI&quot;; font-size: 9.0pt;">想象下面的场景，开发中在多个模块间有某段重复的代码，我们通常是怎么处理的？显然，没有人会靠“复制粘贴”。在传统的面向过程编程中，我们也会将这段代码，抽象成一个方法，然后在需要的地方分别调用这个方法，这样当这段代码需要修改时，我们只需要改变这个方法就可以了。然而需求总是变化的，有一天，新增了一个需求，需要再多出做修改，我们需要再抽象出一个方法，然后再在需要的地方分别调用这个方法，又或者我们不需要这个方法了，我们还是得删除掉每一处调用该方法的地方。实际上涉及到多个地方具有相同的修改的问题我们都可以通过 AOP 来解决。</span></div></li></ul></ul><li><div><span style="font-size: 12pt;"><br/></span></div></li></ul><li><div><span style="font-size: 12pt;">pagehelper myBatis分页插件</span></div></li><li><div><span style="font-size: 12pt;">fastjson 把后台要传给前台的数据转为json字符串</span></div></li><li><div><span style="font-size: 12pt;">jackson-databind json格式的数据和类对象的互相转换</span></div></li><li><div><span style="font-size: 12pt;">maven-compiler-plugin 编译插件</span></div></li></ul><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">(2)core.pom.xml</span></div><ul><li><div><span style="font-size: 12pt;">aliyun-sdk-oss 阿里云oss对象存储</span></div></li><li><div><span style="font-size: 12pt;">mysql-connector-java mysql驱动,连接数据库</span></div></li><li><div><span style="font-size: 12pt;">druid 连接池  提供数据库连接对象</span></div></li><li><div><span style="font-size: 12pt;">mybatis myBatis框架 持久层框架(底层还是使用JDBC,是对JDBC的封装)</span></div></li><li><div><span style="font-size: 12pt;">mybatis-spring myBatis和Spring的整合</span></div></li><li><div><span style="font-size: 12pt;">spring-jdbc Spring和JDBC的整合</span></div></li><li><div><span style="font-size: 12pt;">org.mybatis.generator myBatis代码生成器插件</span></div></li></ul><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">(3)api.pom.xml</span></div><ul><li><div><span style="font-size: 12pt;">org.freemarker freemarker 数据+模板=输出文本(HTML,XML,java源代码,word等等)</span></div></li><li><div><span style="font-size: 12pt;">tomcat7-maven-plugin tomcat7插件  自定义端口8888</span></div></li></ul><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">(4)admin.pom.xml</span></div><ul style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 40px; border: 1px solid transparent; color: rgb(0, 0, 0); font-family: 微软雅黑; font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><li style="box-sizing: border-box; margin: 0px; padding: 0px; border: 1px solid transparent;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; font-size: 12pt;">org.freemarker freemarker 数据+模板=输出文本(HTML,XML,java源代码,word等等)</span></div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; border: 1px solid transparent;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; font-size: 12pt;">tomcat7-maven-plugin tomcat7插件  自定义端口9999</span></div></li><li><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">spring-context-support</span></div></li></ul><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 16px;">(5)依赖管理:</span></div><ul><li><div><span style="font-size: 12pt;">如果所有的子项目都需要使用同一个包，就添加</span><span style="font-size: 12pt;">在parent中，parent中添加dependency，所有子项目都会自动获取该依赖</span></div></li><li><div><span style="font-size: 12pt;">如果只有某个子项目用的，就直接加到子项目就可以了</span></div></li><li><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">假如只有部份子项目用到，就使用dependencyManagement来进行统一版本管理</span><br/></div></li></ul><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">8.插件一个app项目,存放前台的css,js,html</span></div><div style="text-align: center; box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 14pt;"><b><br/></b></font></div><div style="text-align: center; box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 14pt;"><b>项目总结</b></font></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 12pt;">1.ajax是不能跨域的,form表单提交不支持put,delete请求,所以需要解决跨域问题,需要在后台mvc添加配置,在前台设置ajax默认属性,来允许跨域带cookie</font></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 12pt;">2.登录成功要后台设置session来存储当前登录的用户,前台要使用</font><span style="font-size: 12pt;">sessionStorage存储用户信息(注意,在前台拿到的是json对象,这里要用</span><span style="font-size: 12pt;">Json.stringify 转为json字符串再储存进去,要取值的时候用Json.parse</span><span style="font-size: 12pt;">)</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 12pt;">3.前台拿到数据之后使用jrender插件来进行渲染</font></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 12pt;">4.注销用户的时候前台要清除</font><span style="font-size: 12pt;">sessionStorage,后台要销毁session对象</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">5.</span><span style="font-size: 12pt;">simpleProfiles用的是侧边栏,如果</span><span style="font-size: 12pt;">用a标签跳转到其他页面,也会变成侧边栏,所有要在a标签中加入target=&quot;_parent&quot;属性</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">6.背景图片的回显需要用到css,不能用jrender</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">7.后台需要接收数据,而前台不需要显示的,用隐藏域</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">8.后台图片上传,使用了阿里云图片服务器OSS</span><span style="font-size: 12pt;">,直接用提供的文件上传工具</span><span style="font-size: 12pt;">,最后需要根据插件规定的结果map返回,statue状态(1成功,0失败)</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">9.前台图片上传,要有一个隐藏表单style=&quot;display:none&quot;,跳转方式是post,enctype=&quot;multipart/form-data&quot;</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">10.更新user信息之后,记得要重新设置</span><span style="font-size: 12pt;">sessionStorage(从后台jsonResult中设置user回来)</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">11.接口安全处理,自定义注解,</span><span style="font-size: 12pt;">,然后贴在需要登录才能访问的方法上面,利用拦截器检查session.mvc配置拦截器</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">12.</span><span style="font-size: 12pt;">admin的地区管理页面,</span><span style="font-size: 12pt;">利用treeview插件显示地区(</span><span style="font-size: 12pt;">需要根据规定的格式显示</span><span style="font-size: 12pt;">),使用了额外sql懒加载来查询子地区</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">13.admin</span><span style="font-size: 12pt;">动态显示table的数据</span><span style="font-size: 12pt;">,</span><span style="font-size: 16px;">点击左边的地区,把子地区显示在右边的table中,因为发的是异步请求,不经过freemarker视图解析器,所有不能用freemarker标签来循环回显;所有这里通过表格克隆来处理</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 16px;">14.app中使用用到分页的时候,</span><span style="font-size: 12pt;">利用flag标记是否加载中,解决请求重复发送的问题</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">15.</span><span style="font-size: 12pt;">利用滚动事件,判断是否已经滚动到底部,如果已经到底部,再判断当前页是否超过总页数,如果不是,就继续查询</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">16.下一个页面需要前一个页面的渲染后的数据,可以通过render-key和render-fun</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">17.添加文章内容,使用了富文本插件,</span><span style="font-size: 12pt;">Edr.append(data.travelContent.content)回显</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">18.</span><span style="font-size: 12pt;">富文本编辑器的上传图片:设置接收的参数名为upload,返回时的状态uploaded(1成功,0失败)</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">19.二级联动,用值改变事件,但是一开始编辑回显大攻略的时候,给val赋值不会触动值改变事件,所以还是要发get请求去获取攻略目录</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">20.指定前端期望接收的数据格式</span><span style="font-size: 12pt;">headers = &quot;accept=text/html&quot;</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">21.freemarker合成模板,把指定地区的当季推荐攻略和全部攻略查询出来,后台合成模板为HTML的格</span><font style="font-size: 12pt;">式,template.process(map, response.getWriter());这里分页用到分页插件,注意不要配置分页合理化</font></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 12pt;">22.</font><span style="font-size: 12pt;">根据大攻略id查询攻略目录信息,查询目录的同时使用懒加载把文章也查询出来,这里用到了懒加载,使用到了代理对象,会产生一个handler属性,handler不能转为json格式的,所以要用</span><span style="font-size: 12pt;">@JsonIgnoreProperties(&quot;handler&quot;) 转json数据的时候把该属性忽略掉</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-size: 12pt;">23.循环回显数组的图片(l</span><span style="font-size: 12pt;">ist.imgArr.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">self</span>)</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px;"><font style="font-size: 12pt;">24.数组传值时，不添加[]($.ajaxSettings.traditional = true;)</font></div><div><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;"><br/></span></div><div><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;"><br/></span></div><div><span style="color: rgb(77, 77, 77); font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px;"><br/></span></div><div><br/></div></div></span>
</div></body></html> 